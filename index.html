<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <title>NovaCore Gateway | RGPD Compliance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background: #050505; color: #e5e5e5; font-family: 'Inter', sans-serif; }</style>
</head>
<body class="p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-10">
            <h1 class="text-xl font-bold italic tracking-tighter">NOVACORE <span class="text-blue-500">GATEWAY</span></h1>
            <div class="px-4 py-1 rounded-full border border-blue-500/30 text-blue-400 text-[10px] animate-pulse">● NÓ DE SEGURANÇA ATIVO (UE)</div>
        </header>

        <main class="bg-white/5 border border-white/10 rounded-3xl p-8 min-h-[400px] flex flex-col">
            <div id="chat-output" class="flex-grow overflow-y-auto space-y-4 mb-6 text-sm text-gray-400 font-light text-justify">
                Sistema pronto para processamento seguro...
            </div>
            <div class="flex gap-4">
                <input id="user-input" type="text" placeholder="Escreva a sua instrução..." class="w-full bg-white/5 border border-white/10 rounded-xl px-6 py-4 focus:outline-none focus:border-blue-500">
                <button onclick="send()" class="bg-blue-600 px-8 py-4 rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-blue-500 transition-all">Enviar</button>
            </div>
        </main>
        
        <button onclick="fetchLogs()" class="mt-6 text-[10px] text-gray-500 uppercase hover:text-red-400 transition-all tracking-[0.2em]">Consultar Relatório de Auditoria RGPD</button>
        <pre id="log-view" class="hidden mt-4 p-4 bg-black border border-red-900/20 rounded-xl text-[10px] text-red-400/70 max-h-40 overflow-y-auto font-mono"></pre>
    </div>

    <script>
        async function send() {
            const input = document.getElementById('user-input');
            const out = document.getElementById('chat-output');
            if(!input.value) return;
            
            const res = await fetch('http://localhost:3000/api/chat', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ message: input.value })
            });
            const data = await res.json();
            out.innerHTML += `<div class="p-4 bg-white/5 rounded-xl border-l-2 border-blue-500"><span class="text-[9px] text-blue-400 uppercase font-bold">FONTE: ${data.provider} | LATÊNCIA: ${data.latency_ms}ms</span><br>${data.reply}</div>`;
            input.value = "";
            out.scrollTop = out.scrollHeight;
        }

        async function fetchLogs() {
            const logEl = document.getElementById('log-view');
            const res = await fetch('http://localhost:3000/api/logs');
            const text = await res.text();
            logEl.innerText = text || "Nenhum log registado até ao momento.";
            logEl.classList.toggle('hidden');
        }
    </script>
</body>
</html>